"use strict";function AddController(a,b){var c=this;b.venue={},c.submitKey=function(d){a.post("/venues/verify",c.venue).then(function(a){console.log(a),a.data.points&&(b.$parent.user.points=a.data.points,b.$parent.user.locations.push(d),console.log(b.$parent.user.locations))})},c.visited=function(a){return b.$parent.user.locations.includes(a)?!0:!1},c.fireTest=function(){a.get("/auth/logout").then(function(a){console.log(a)})}}function LeaderboardController(){this.userslist=[{displayName:"Moist FlipFlop",score:2},{displayName:"Not Cheating",score:4},{displayName:"Greatest Ever",score:5},{displayName:"Steve Jobs",score:10},{displayName:"Steve Wozniak",score:12},{displayName:"John Ives",score:11},{displayName:"Independant Port",score:18},{displayName:"Lukewarm Lasagna",score:22}]}function UserController(){}function VisitedController(a){$.getScript("progressbar.js/dist/progressbar.js").then(function(){var b=a.$parent.venues,c=a.$parent.user,d=new ProgressBar.Circle(container,{color:"#aaa",strokeWidth:14,trailWidth:11,easing:"easeInOut",duration:1400,text:{autoStyleContainer:!1},from:{color:"rgb(238, 30, 123)",width:11},to:{color:"rgb(238, 30, 123)",width:14},step:function(a,b){b.path.setAttribute("stroke",a.color),b.path.setAttribute("stroke-width",a.width);var c=Math.round(100*b.value());0===c?b.setText("%"):b.setText(c+"%")}});d.text.style.fontFamily='"Raleway", Helvetica, sans-serif',d.text.style.fontSize="2rem";var e=c.points/b.length;d.animate(e)})}function CenterControl(a,b){var c=document.createElement("div");c.style.backgroundColor="rgba(255,215,36,.75)",c.style.borderRadius="3px",c.style.boxShadow="0 2px 6px rgba(0,0,0,.3)",c.style.cursor="pointer",c.style.marginBottom="22px",c.style.textAlign="center",c.title="Click to recenter the map",a.appendChild(c);var d=document.createElement("div");d.style.color="rgb(25,25,25)",d.style.fontFamily="Roboto,Arial,sans-serif",d.style.fontSize="2.2em",d.style.lineHeight="38px",d.style.paddingLeft="5px",d.style.paddingRight="5px",d.innerHTML="&#9672",c.appendChild(d)}function ZoomControl(a,b){a.style.padding="0 2vw 2vh 0";var c=document.createElement("div");c.style.cursor="pointer",c.style.textAlign="center",c.style.width="15vw",c.style.height="30vw",a.appendChild(c);var d=document.createElement("div");d.style.width="15vw",d.style.height="15vw",d.style.backgroundColor="rgba(255,215,36,.75)",d.style.fontWeight="500",d.style.fontSize="64px",d.style.lineHeight="54px",d.style.margin="auto",d.innerHTML="&#43;",d.style.borderRadius="4px",c.appendChild(d);var e=document.createElement("div");e.style.width="15vw",e.style.backgroundColor="rgba(255,215,36,.75)",e.style.height="15vw",e.innerHTML="&#45;",e.style.fontSize="64px",e.style.lineHeight="50px",e.style.fontWeight="700",e.style.margin="1vh auto 0px",e.style.borderRadius="4px",c.appendChild(e),google.maps.event.addDomListener(d,"click",function(){b.setZoom(b.getZoom()+1)}),google.maps.event.addDomListener(e,"click",function(){b.setZoom(b.getZoom()-1)})}function myMap(){function a(){function a(a){coords={lat:a.coords.latitude,lng:a.coords.longitude},map.panTo(coords),map.setZoom(18),l=new google.maps.Marker({position:{lat:coords.lat,lng:coords.lng},map:map,icon:"/images/person.5283fad5.png"})}function b(){console.log("Location cannot be used/found")}if(navigator.geolocation){var c={enableHighAccuary:!0,timeout:5e3,maximumAge:0};navigator.geolocation.getCurrentPosition(a,b,c)}}var b=new google.maps.LatLng(36.743129,-119.800229),c=new google.maps.LatLng(36.742353,-119.803104),d=new google.maps.LatLng(36.7436,-119.801833),e=new google.maps.LatLng(36.728567,-119.787868),f=new google.maps.LatLng(36.74062,-119.782663),g=new google.maps.LatLng(36.735943,-119.7779),h=new google.maps.LatLng(36.743337,-119.789315),i=new google.maps.LatLng(36.733577,-119.789057),j=document.getElementById("map"),k={center:i,zoom:14,styles:styles,disableDefaultUI:!0};map=new google.maps.Map(j,k);var l;a();var m=document.createElement("div");new CenterControl(m,map);m.index=1,map.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(m),m.addEventListener("click",function(){l&&l.setMap(null),a()});var n=document.createElement("div");new ZoomControl(n,map);n.index=1,map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(n);var o=[b,d,c,e,g,f,h],p=new google.maps.Polygon({paths:o,strokeColor:"#16a085",strokeOpacity:.4,strokeWeight:2,fillColor:"#EAEA10",fillOpacity:.1});google.maps.Polygon.prototype.getBounds=function(){for(var a,b=new google.maps.LatLngBounds,c=this.getPaths(),d=0;d<c.getLength();d++){a=c.getAt(d);for(var e=0;e<a.getLength();e++)b.extend(a.getAt(e))}return b},map.fitBounds(p.getBounds()),p.setMap(map);var q=new mapData(map);q.getMarkers()}function loadModal(){setTimeout(function(){$("#searchIt").modal("show")},1e3)}function mapData(a){this.getMarkers=loadMarkers}function loadMarkers(){var a=[],b=[];$.get("/venues",function(c){b=c,b.forEach(function(b){var c=b.location,d=b.name,e=b.address,f=new google.maps.Marker({map:map,position:c,title:d,animation:google.maps.Animation.BOUNCE});setTimeout(function(){f.setAnimation(null)},1600),a.push(f),f.addListener("click",function(){var a=new google.maps.InfoWindow({content:"<div><strong>"+this.title+"</string><p>"+e+"</p></div"});a.open(map,f)})})})}angular.module("arthopMapApp",["ngAnimate","ngCookies","ngResource","ngTouch","ui.router","satellizer"]),AddController.$inject=["$http","$scope"],angular.module("arthopMapApp").controller("AddController",AddController),angular.module("arthopMapApp").controller("LeaderboardController",LeaderboardController),angular.module("arthopMapApp").controller("UserController",UserController),VisitedController.$inject=["$scope"],angular.module("arthopMapApp").controller("VisitedController",VisitedController);var mapAPI="AIzaSyChR-T7PCcwMidHQ9rnEP_1zhfjjlZajAs",apiScript=document.createElement("script");apiScript.setAttribute("src","https://maps.googleapis.com/maps/api/js?key="+mapAPI+"&callback=myMap");var lastElement=document.body.lastChild;lastElement.appendChild(apiScript);var coords,map;!function(){angular.module("arthopMapApp").config(["$stateProvider","$authProvider",function(a,b){b.httpInterceptor=function(){return!0},b.withCredentials=!1,b.tokenRoot=null,b.baseUrl="/",b.loginUrl="/auth/login",b.unlinkUrl="/auth/unlink/",b.tokenName="token",b.tokenPrefix="satellizer",b.tokenHeader="Authorization",b.tokenType="Bearer",b.storageType="localStorage",b.google({clientId:"754975649922-j1anol2frgcnoqp2tb0m8l7sc5i17puo.apps.googleusercontent.com",url:"/auth/google",authorizationEndpoint:"https://accounts.google.com/o/oauth2/auth",redirectUri:window.location.origin,requiredUrlParams:["scope"],optionalUrlParams:["display"],scope:["profile","email"],scopePrefix:"openid",scopeDelimiter:" ",display:"popup",oauthType:"2.0",popupOptions:{width:452,height:633}});var c={name:"login",url:"/login",templateUrl:"/views/panelStates/login.html",controller:"UserController as ctrl"},d={name:"user",url:"/user",templateUrl:"/views/panelStates/user.html",controller:"UserController as ctrl"},e={name:"leaderboard",url:"/leaderboard",templateUrl:"/views/panelStates/leaderboard.html",controller:"LeaderboardController as ctrl"},f={name:"visited",url:"/visited",templateUrl:"/views/panelStates/visited.html",controller:"VisitedController as ctrl"},g={name:"add",url:"/add",templateUrl:"/views/panelStates/add.html",controller:"AddController as ctrl"};a.state(c),a.state(d),a.state(e),a.state(f),a.state(g)}]).directive("searchButton",function(){return{restrict:"E",templateUrl:"views/panel/panel-button.html"}}).directive("searchModal",function(){return{restrict:"E",templateUrl:"views/panel/panel-modal.html",controller:"panelCtrl"}}).controller("panelCtrl",["$scope","$http","$auth","$state",function(a,b,c,d){a.authenticate=function(e){c.authenticate(e).then(function(c){b.get("/api/me").then(function(b){a.user=b.data,d.go("user")},function(a){console.log("Sorry could't retrieve user information",a),d.go("login")})})},a.isAuthenticated=function(){return c.isAuthenticated()},b.get("/venues").success(function(b){a.venues=b}),a.isAuthenticated()&&b.get("/api/me").then(function(b){a.user=b.data,d.go("user")},function(a){console.log("Sorry couldn't retrieve user information",a),d.go("login")}),a.logout=function(){c.logout().then(function(a){c.removeToken(),d.go("login")})["catch"](function(a){console.log("Error with loggin you out."),d.go("user")})}}])}(window.angular);var styles=[];angular.module("arthopMapApp").run(["$templateCache",function(a){a.put("views/panel/panel-button.html",'<div class="menuButton" ng-if="isAuthenticated()"> <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#searchIt" ui-sref="user"> &#9776 </button> </div> <div class="menuButton" ng-if="!isAuthenticated()"> <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#searchIt" ui-sref="login"> &#9776 </button> </div>'),a.put("views/panel/panel-modal.html",'<!--make search input in modal autofocus--><!--optimize search filter--> <style type="text/css">.validated {\n    background-color: #99ff99;\n  }\n  .modal-header .glyphicon {\n    color: white;\n    background: rgba(255,255,255,.2);\n    border: 1px solid rgba(255,255,255,.4);\n    border-radius: 5px;\n    padding: 5px;\n    font-size: 1.8em;\n  }</style> <!-- Modal --> <div class="modal fade" id="searchIt" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"> <div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header"> <h4 class="modal-title" id="myModalLabel"> <div ng-if="isAuthenticated()"> <strong> <a ui-sref="user"> <span class="glyphicon glyphicon-user" aria-hidden="true"></span></a> <a ui-sref="leaderboard"> <span class="glyphicon glyphicon-tower" aria-hidden="true"></span></a>  <a ui-sref="visited"> <span class="glyphicon glyphicon-dashboard" aria-hidden="true"></span></a>  <a ui-sref="add"> <span class="glyphicon glyphicon-plus" aria-hidden="true"></span></a>  <a href="#" ng-click="logout()"> <span class="glyphicon glyphicon-log-out" aria-hidden="true"></span></a>  </strong> </div> <div ng-if="!isAuthenticated()"> <a ui-sref="login" ui-sref-active="active">Log In</a> </div> </h4> </div> <div class="modal-body"> <!-- BODY --> <ui-view></ui-view> </div> <hr> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">Close</button> </div> </div> </div> </div>'),a.put("views/panelStates/add.html",'<style>.success {\n  background-color: #99ff99;\n}\n.success input {\n  visibility: hidden;\n  max-height: 0px;\n  margin-top: -5px;\n}\n.success h4, .success p  {\n  margin: 0px;\n}\n.success h4  {\n  font-weight: 700;\n  font-size: 2.2em;\n  margin-top: 10px;\n}\ninput.input-medium {\n  background: #FFF;\n  font-size: 2.2rem;\n  height: 8vh;\n}\ninput.input-medium:focus {\n  border-color: #12A79D;\noutline: 0;\n-webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);\nbox-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);\n}\ninput.input-medium::-webkit-input-placeholder { /* Chrome/Opera/Safari */\n  font-size: 2.2rem;\n  text-align: center;\n}\ninput.input-medium::-moz-placeholder { /* Firefox 19+ */\n  color: pink;\n}\ninput.input-medium:-ms-input-placeholder { /* IE 10+ */\n  color: pink;\n}\ninput.input-medium:-moz-placeholder { /* Firefox 18- */\n  color: pink;\n}</style> <input ng-model="query" placeholder="Search for locations" class="input-medium search-query form-control"> <hr class="m-t-1"> <div class="list-group pre-scrollable"> <li ng-repeat="item in venues | filter: query" ng-class="{\'success\': ctrl.visited(item.name)}" class="list-group-item p-y-2" style="text-align: center"> <div class="form-group"> <h4>{{item.name}} </h4> <p>{{item.address}}</p> <span ng-show="ctrl.visited(item.name)" class="glyphicon glyphicon-ok" style="float:left; font-size: 2.2em; position: absolute; left: 1em; transform: translateY(-50%); top: 50%"></span> <form name="form" ng-submit="ctrl.submitKey(item.name)"> <div class="input-group"> <input name="key" ng-disabled="ctrl.visited(item.name)" ng-model="ctrl.venue[item.name].key" type="text" class="form-control" placeholder="Example Business Key..."> <span class="input-group-btn"> <input class="btn btn-secondary" ng-disabled="ctrl.visited(item.name)" type="submit">Submit </span> </div> </form> </div> </li> </div>'),a.put("views/panelStates/leaderboard.html",'<style>td{\n  padding: 2vmin;\n  width: 15%;\n}</style> <h1 style="text-align:center">Leaderboard</h1><hr> <table> <tr class="table-row" ng-repeat="current in ctrl.userslist | orderBy:\'-score\'"> <td>{{$index + 1}}</td> <td>{{current.displayName}}</td> <td>{{current.score}}</td> </tr> </table>'),a.put("views/panelStates/login.html","<button ng-click=\"authenticate('google')\">Sign in with Google</button>"),a.put("views/panelStates/user.html",'<style>.user-center {\n  font-weight: 600;\n  text-align: center;\n}\n\n.user-subText {\n  font-weight: 300;\n}\n\n.profile-photo {\n  border-radius: 50%;\n  height: 20%;\n  width: auto;\n}</style> <button ng-if="!isAuthenticated()" ng-click="authenticate(\'google\')">Sign in with Google</button> <div class="user-center"> <img src="{{user.picture}}" class="profile-photo"> <h2>Display Name <br><h3 class="user-subText">{{user.displayName}}</h3></h2> <h2>Score <br><h3 class="user-subText">{{user.points}}</h3></h2> </div>'),a.put("views/panelStates/visited.html",'<h1 style="text-align:center; padding-bottom: 5vh">Progress</h1> <style media="screen">#container {\n    margin: auto;\n    width: 200px;\n    height: 200px;\n    position: relative;\n  }</style> <div id="container"></div>')}]);